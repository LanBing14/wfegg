<template>
  <div id="order_details">
    <mt-header fixed title="è®¢å•è¯¦æƒ…" style="font-size:1.2rem;height: 3rem;">
      <mt-button icon="back" slot="left" @click="goBack"></mt-button>
    </mt-header>
    
  <!--  å¾…æ”¶è´§æ¨¡å—-->
      <div class="collect_momdel" v-if="show1" style="display: none;">
	    <!--ç­‰å¾…ä¹°å®¶æ”¶è´§æé†’-->
			    <div class="waitReceiving">
			    	<img src="../../img/stay_icon.png"/>
			      <p>{{zhuangtai}}</p>
			      <div class="btns">
			        <div class="applyBtn applyFor">ç”³è¯·é€€æ¬¾</div>
			        <div class="applyBtn active" @click="goEvaluate">ç¡®è®¤æ”¶è´§</div>
			      </div>
			    </div>
			    <!--æ”¶è´§äººä¿¡æ¯-->
			    <div class="Consignee">
			      <div class="messages">
			        <p class="name">{{receiver}}
			          <span class="phone">{{phone}}</span>
			        </p>
			        <div class="add">
			          <img src="../../img/map.png" alt="" class="sign">
			          <p class="address">{{address}}</p>
			          <img src="../../img/right.png" alt="" class="right">
			        </div>
			      </div>
			     
			    </div>
			    <!--å•†å“ä¿¡æ¯-->
			    <div class="productInfo">
			      <img src="../../img/swiper.png" alt="" class="goodPic" >
			      <div class="line1">
			        <p class="name">{{packageInfo.goodsName}}</p>
			        <p class="money">ï¿¥{{packageInfo.sellPrice}}</p>
			      </div>
			      <div class="line2">
			        <p class="guige"></p>
			        <p class="num">30æš</p>
			      </div>
			    </div>
			    <!--å…¶ä»–-->
			    <div class="other">
			      <p>é…é€æ–¹å¼ï¼šå¿«é€’ ï¿¥{{freight}}</p>
			      <p>ç§¯åˆ†æŠµæ‰£ï¼š{{discount? discount:0}}</p>
			      <p>ä¹°å®¶ç•™è¨€ï¼š<input type="text" placeholder="é€‰å¡«" style="width: 75%;font-size: 1rem;line-height: 1.1rem;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;"></p>
			    </div>
			    <!--åˆè®¡-->
			    <div class="total">
			      <p>æ€»è®¡
			        <span>ï¿¥{{packageInfo.sellPrice}}</span>
			      </p>
			    </div>
			    <!--è®¢å•ä¿¡æ¯-->
			    <div class="orderDetails">
			      <div class="title">è®¢å•ä¿¡æ¯</div>
			      <div class="line">
			        <p class="p1">ä¸‹å•æ—¶é—´</p>
			        <p class="p2">{{packageInfo.addTime}}</p>
			      </div>
			      <div class="line">
			        <p class="p1">ä»˜æ¬¾æ—¶é—´</p>
			        <p class="p2">{{packageInfo.payTime}}</p>
			      </div>
			    </div>
			    <!--è®¢å•ä¿¡æ¯end-->
	    </div>
  <!--å¾…æ”¶è´§æ¨¡å—end-->
  
  <!--å¾…è¯„ä»·æ¨¡å—-->
     <div class="review_momdel" v-if="show2">
     	
	    <!--ç­‰å¾…ä¹°å®¶æ”¶è´§æé†’-->
			    <div class="waitReceiving">
			    	<img src="../../img/review-icons.png"/>
			      <p>{{zhuangtai}}</p>
			      <!--<div class="btns">
			        <div class="applyBtn applyFor">ç”³è¯·é€€æ¬¾</div>
			        <div class="applyBtn active" @click="goEvaluate">ç¡®è®¤æ”¶è´§</div>
			      </div>-->
			    </div>
			    
			    <!--ç‰©æµä¿¡æ¯-->
			      <div class="logistics_information">
			      	  <img src="../../img/car.png"/>  
			      	  <p style="padding-top: 1.25rem;">ç‰©æµä¿¡æ¯:<span>{{KdName}}</span></p>
			      	  <p >å¿«é€’å•å·ï¼š<input id="copyObj" :value="kdNo" /> <span class="single_number" @click="copyNum">å¤åˆ¶å•å·</span></p>
			      </div>
			    <!--ç‰©ç†ä¿¡æ¯end-->
			    
			    <!--æ”¶è´§äººä¿¡æ¯-->
			    <div class="Consignee">
			      <div class="messages">
			        <p class="name">{{receiver}}
			          <span class="phone">{{phone}}</span>
			        </p>
			        <div class="add">
			          <img src="../../img/map.png" alt="" class="sign">
			          <p class="address">{{address}}</p>
			          <!--<img src="../../img/right.png" alt="" class="right">-->
			        </div>
			      </div>
			     
			    </div>
			    <!--å•†å“ä¿¡æ¯-->
			    <div class="productInfo">
			      <img src="../../img/swiper.png" alt="" class="goodPic" style="width: 5.6875rem;height: 6.5625rem;">
			      <div class="line1">
			        <p class="name">{{packageInfo.goodsName}}</p>
			        <p class="money" style="margin-top: 1.5rem;">ï¿¥{{packageInfo.sellPrice}}</p>
			      </div>
			      <div class="line2">
			        <p class="guige" style="margin: 1rem;"></p>
			        <p class="num">30æš</p>
			      </div>
			    </div>
			  <!--å¤‡æ³¨ä¿¡æ¯-->
			    <div class="remarks_information">å¤‡æ³¨:{{remark}}</div>
			   <!-- å¤‡æ³¨ä¿¡æ¯end-->
			    <!--è®¢å•ä¿¡æ¯-->
			    <div class="orderDetails">
			       <div class="title">è®¢å•ä¿¡æ¯</div>
			       <p class="line" style="padding-top:0.5rem ;">å‘è´§æ—¶é—´<span class="p2">{{sendTime}}</span></p>
			    </div>
			    <!--è®¢å•ä¿¡æ¯end-->
			    
	    </div>
  <!--å¾…è¯„ä»·æ¨¡å—end-->
  </div>
</template>

<script>
import { Header } from "mint-ui";
import { MessageBox } from "mint-ui";
import axios from "axios";
import qs from "qs";
export default {
  name: "order_details",
  data() {
    return {
      packageInfo: "",
      goodsName: "",
      dateTime: "",
      number: "",
      sellPrice: "",
      freight: "",
      amount: "",
      addTime: "",
      discount: "",
      payTime: "",
      addTime: "",
      remark: "",
      receiver: "", //æ”¶è´§äºº
      phone: "", //æ‰‹æœºå·
      address: "",
      show1: false,
      show2: true,
      zhuangtai: "",
      kdNo: "",
      sendTime: "",
      KdName: ""
    };
  },
  methods: {
    //è¿”å›ä¸Šä¸€çº§
    goBack() {
      this.$router.back();
    },
    //ç‚¹å‡»åœ°å€ä¿¡æ¯ä¸€å—ğŸ‘‰'create_address'
    goAddress() {
      this.$router.push({
        path: "/create_address",
        query: { orderId: this.$router.query.orderId }
      });
    },
    // ç‚¹å‡»ç¡®è®¤æ”¶è´§
    goEvaluate() {
      //  å…ˆå¼¹å‡ºæ˜¯å¦ç¡®è®¤æ”¶è´§çš„å¼¹æ¡†ï¼Œå†è·³è½¬åˆ°è¯„ä»·
      MessageBox.confirm("", {
        message: "æ˜¯å¦ç¡®è®¤æ”¶è´§",
        confirmButtonText: "ç¡®è®¤",
        cancelButtonText: "å–æ¶ˆ",
        showCancelButton: true
      })
        .then(action => {
          if (action == "confirm") {
            //ç¡®è®¤çš„å›è°ƒ
            this.$router.push({ path: "/evaluate" });
          }
        })
        .catch(err => {
          if (err == "cancel") {
            //å–æ¶ˆçš„å›è°ƒ
            console.log(2);
          }
        });
    },
    datas: function() {
      this.zhuangtai = this.$route.query.name;
      this.KdName = this.$route.query.kdNames;
      this.kdNo = this.$route.query.kdNos;
      this.sendTime = this.$route.query.shi;
      if (this.zhuangtai == "å·²å‘è´§") {
        //  		 this.show1 = false;
        this.show2 = true;
      } else if (this.zhuangtai == "å¾…è¯„ä»·") {
        //  		 this.show1 = false;
        this.show2 = true;
      }
      var $this = this;
      var baseUrl = BaseUrl + "api/getOrderDetail";
      var data = qs.stringify({
        id: $this.$route.query.orderId, //335

        openid: localStorage.getItem("openid")
      });
      console.log(data);
      axios({
        method: "post",
        url: baseUrl,
        type: "json",
        data: data
      })
        .then(function(data) {
          console.log(data);
          let datas = data.data.data;
          if (data.data.status == 1) {
            $this.receiver = datas.name;
            $this.phone = datas.phone;
            $this.remark = datas.remark;
            $this.address = datas.address;
            $this.packageInfo = datas.packageInfo;
            $this.amount = datas.amount;
            $this.addTime = datas.addTime;
            $this.payTime = datas.payTime;
            $this.discount = datas.discount;
            $this.freight = datas.freight;
          } else {
            alert(datas.msg);
          }
        })
        .catch(function() {});
    },
    Address() {
      var $this = this;
      var baseUrl = BaseUrl + "api/getAddressList";
      var data = qs.stringify({
        //            openid:'oX6js0S0Pqsh6ijuNs48kDFN3w6s',
        openid: localStorage.getItem("openid")
      });
      axios({
        method: "post",
        url: baseUrl,
        type: "json",
        data: data
      })
        .then(function(data) {
          console.log(data);
          let datas = data.data.data;
          if (data.data.status == 1) {
            for (var i in datas) {
              if ((datas[i].isDefault = 1)) {
                ($this.receiver = datas[i].receiver), //æ”¶è´§äºº
                  ($this.phone = datas[i].phone); //æ‰‹æœºå·
                $this.address = datas.address;
              }
            }
          } else {
            alert(datas.msg);
          }
        })
        .catch(function() {
          //alert("ç¨‹åºå¼‚å¸¸ï¼Œè”ç³»æŠ€æœ¯äººå‘˜")
        });
    },
    copyNum() {
      var url = document.querySelector("#copyObj");
      url.select(); // é€‰æ‹©å¯¹è±¡
      document.execCommand("Copy");
    }
  },
  mounted() {
    this.Address();
    this.datas();
  },
  components: {}
};
</script>

<style lang="scss" scoped>
#order_details {
  background: #f0f0f2;
  height: 42rem;
  .mint-header {
    background: #cc3e36;
  }
  /*ç­‰å¾…ä¹°å®¶æ”¶è´§æé†’*/
  .waitReceiving {
    margin-top: 3rem;
    background: #fff;
    padding: 1.5rem;
    img {
      margin-left: 38%;
      width: 1.625rem;
      height: 1.625rem;
    }
    p {
      margin-right: 38%;
      float: right;
      display: inline-block;
      text-align: center;
      font-size: 0.9rem;
      color: #cc3e36;
      padding-top: 0.2rem;
    }
    .btns {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 65%;
      margin: 0 auto;
      margin-top: 1rem;
      .applyFor {
        margin-right: 0.5rem;
      }
      .applyBtn {
        border: 1px solid #bbb;
        border-radius: 5rem;
        font-size: 0.9rem;
        line-height: 1.8rem;
        width: 6rem;
        text-align: center;
      }
      .active {
        border: 1px solid #cc3e36;
        color: #cc3e36;
      }
    }
  }
  /*ç‰©æµä¿¡æ¯*/
  .logistics_information {
    height: 4.125rem;
    background-color: #ffffff;
    margin-top: 0.4375rem;

    img {
      display: block;
      width: 1.6875rem;
      height: 1.3125rem;
      float: left;
      margin: 1.4375rem 1.3125rem 1.4375rem 1.8125rem;
    }
    p {
      font-size: 0.75rem;
      color: #999999;
      .single_number {
        color: #cc3e36;
        font-size: 0.75rem;
      }
    }
  }
  /*æ”¶è´§äººä¿¡æ¯*/
  .Consignee {
    display: flex;
    align-items: center;
    margin-top: 0.4375rem;
    padding: 0.2rem 0.8rem;
    height: 6rem;
    background: #fff;
    .messages {
      width: 100%;
      .name {
        font-size: 1rem;
        .phone {
          margin-left: 1rem;
        }
      }
      .add {
        display: flex;
        align-items: center;
        margin-top: 0.5rem;
        font-size: 0.8rem;
        .sign {
          width: 1.2rem;
          height: 1.3rem;
        }
        .address {
          width: 95%;
          color: #c1c5c8;
        }
      }
    }
    img {
      width: 24px;
      height: 28px;
    }
  }
  /*å•†å“ä¿¡æ¯*/
  .productInfo {
    width: 100%;
    margin-top: 0.5rem;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    background: #ffffff;
    border-bottom: 1px solid #c1c5c8;
    .goodPic {
      width: 3.75rem;
      height: 3.75rem;
      margin: 0.9rem;
    }
    .line1 {
      width: 65%;
      font-size: 0.9rem;
      margin-top: -2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      .name {
        width: 70%;
        margin-right: 1.5rem;
      }
      .money {
        position: relative;
        text-align: right;
        width: 35%;
      }
    }
    .line2 {
      margin-top: -3rem;
      width: 68%;
      margin-left: 6rem;
      display: flex;
      align-items: left;
      justify-content: left;
      color: #c1c5c8;
      .guige {
        width: 50%;
        margin-right: 3rem;
        font-size: 0.8rem;
      }
      .num {
        text-align: right;
        width: 35%;
        position: relative;
        font-size: 0.8rem;
      }
    }
  }
  /*å¤‡æ³¨ä¿¡æ¯*/
  .remarks_information {
    padding: 0.375rem 0 0 1.1875rem;
    height: 3.4375rem;
    background-color: #ffffff;
    color: #8b8989;
    font-size: 0.75rem;
  }
  /*å…¶ä»–*/
  .other {
    background: #ffffff;
    padding-left: 1rem;
    font-size: 0.925rem;
    border-bottom: 1px solid #c1c5c8;
    padding-bottom: 1rem;
    p {
      line-height: 2.5rem;
      display: flex;
      align-items: center;
    }
  }
  /*åˆè®¡*/
  .total {
    background: #fff;
    text-align: right;
    padding-right: 1rem;
    line-height: 2.5rem;
    p {
      font-size: 1rem;
      span {
        color: #cc3e36;
      }
    }
  }
  /*è®¢å•è¯¦æƒ…*/
  .orderDetails {
    height: 10rem;
    background: #fff;
    margin-top: 0.25rem;
    /*padding: 0 1rem;*/
    font-size: 0.8125rem;
    .title {
      background-color: #ffffff;
      padding: 0 1rem;
      line-height: 2.5rem;
      border-bottom: 2px solid #f2f2f2;
    }
    .line {
      color: #c1c5c8;
      display: flex;
      align-items: center;
      font-size: 0.8125rem;
      line-height: 1.2rem;
      padding: 0 1rem;
    }
  }
}
</style>
